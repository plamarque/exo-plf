<h1 style="color: rgb(255, 204, 51);">eXo Groovy Console</h1>
<h2 style="color: rgb(102, 102, 0);">Description:</h2>
eXo Groovy Console allows you to run Groovy code interactively. It accepts eXo API and can access eXo components deployed in portal container so this can be used as a tool for drafting code, tesing or exploring eXo API/components/data interactively on a live system. 
<br>
<br>
In a session, variables and import statements are saved automatically as session context for user to reference later if needed. Currently class and function definitions are not saved (due to the difficulty of parsing them from a script), however we can send them along with other statements to the console once at a time (as a single command in the console via copy/paste, or as a script)
<br>
<br>
Available session management commands:
<br>
<pre> show imports                            Show imported packages<br> show variables                          Show defined variables<br> list sessions [&lt;regex pattern&gt;]         List all saved sessions which's name matches &lt;regex pattern&gt;<br> clear session                           Clear the session<br> save session as &lt;session name&gt;          Save session<br> load session &lt;session name&gt;             Load session<br> remove session &lt;session name&gt;           Remove session<br> remove all sessions [&lt;regex pattern&gt;]   Remove all session which's name matches &lt;regex pattern&gt;<br></pre>
<br>
<h2 style="color: rgb(102, 102, 0);">The console's GUI:</h2>
We use the <a href="http://terminal.jcubic.pl">JQuery Terminal Emulator plugin</a> for the console's GUI. Below are some useful shotcuts and commands for working with the console (please refer to the plugin's website for more information):
<pre><b>Shotcut keys:</b>
 Up/Down                                 Command history
 PgUp/PgDn                               Scroll up/down
 Ctrl-C/Ctrl-V                           Copy/Paste
 Ctrl-K                                  Remove the text after the cursor
 ESC                                     Clear command line
 
<b>Console commands:</b>
 clear                                   Clear console screen
 edit                                    Show extent editor
 pause                                   Disable terminal
 run                                     Execute content in extent input
</pre>
<br>
<h2 style="color: rgb(102, 102, 0);">Sample sessions:</h2>
<h3 style="color: rgb(255, 212, 0); font-size: 16px;"><span style="color: rgb(255, 204, 0);">
1. Test importing:</span>
</h3>
<pre><b>groovy&gt;</b> println PI<br><span style="color: rgb(153, 0, 0);">ERROR: Error executing script: No such property: PI for class: Script1</span><br><b>groovy&gt;</b> import static java.lang.Math.*<br><b>groovy&gt;</b> println PI<br><span style="color: rgb(0, 153, 0);">3.141592653589793</span><br><b>groovy&gt;</b> println sin(PI/2)<br><span style="color: rgb(0, 153, 0);">1.0</span><br><b>groovy&gt;</b>  <br> </pre>
<h3 style="color: rgb(255, 212, 0); font-size: 16px;"><span style="color: rgb(255, 204, 0);">
2. Test running eXo API and session management commands:</span></h3>
Run the following script line-by-line<br><pre><span style="color: rgb(0, 0, 102);">import javax.jcr.Node;</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">import javax.jcr.Property;</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">import javax.jcr.Repository;</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">import javax.jcr.Session;</span><br style="color: rgb(0, 0, 102);"><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">import org.exoplatform.container.ExoContainerContext;</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">import org.exoplatform.container.StandaloneContainer;</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">import org.exoplatform.services.jcr.RepositoryService;</span><br style="color: rgb(0, 0, 102);"><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">RepositoryService repositoryService = (RepositoryService)ExoContainerContext.getCurrentContainer().getComponentInstanceOfType(RepositoryService.class);</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">Repository repository = repositoryService.getDefaultRepository();</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">Session session = repository.login();</span><br style="color: rgb(0, 0, 102);"><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">Node rootNode = session.getRootNode();</span><br style="color: rgb(0, 0, 102);"><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">println rootNode</span><br style="color: rgb(0, 0, 102);"><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">rootNode.getNodes().each{println it.name}</span><br><br></pre><small><small><big><big>The session:</big></big></small></small><pre><b>groovy&gt;</b> import javax.jcr.Node;<br><b>groovy&gt;</b> import javax.jcr.Property;<br><b>groovy&gt;</b> import javax.jcr.Repository;<br><b>groovy&gt;</b> import javax.jcr.Session;<br><b>groovy&gt;</b> import org.exoplatform.container.ExoContainerContext;<br><b>groovy&gt;</b> import org.exoplatform.container.StandaloneContainer;<br><b>groovy&gt;</b> import org.exoplatform.services.jcr.RepositoryService;<br><b>groovy&gt;</b> <br><b>groovy&gt;</b> show imports<br><span style="color: rgb(0, 153, 0);">[GroovySession@2011.5.16_7h53m4s]</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import org.exoplatform.services.jcr.RepositoryService;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Node;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import org.exoplatform.container.ExoContainerContext;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import org.exoplatform.container.StandaloneContainer;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Repository;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Session;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Property;</span><br><br><b>groovy&gt;</b> RepositoryService repositoryService = (RepositoryService)ExoContainerContext.getCurrentContainer().getComponentInstanceOfType(RepositoryService.class);<br><b>groovy&gt;</b> Repository repository = repositoryService.getDefaultRepository();<br><b>groovy&gt;</b> Session session = repository.login();<br><b>groovy&gt;</b> Node rootNode = session.getRootNode();<br><b>groovy&gt;</b> <br><b>groovy&gt;</b> show variables<br><span style="color: rgb(0, 153, 0);">[GroovySession@2011.5.16_7h53m4s]</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">repositoryService = (RepositoryService)ExoContainerContext.getCurrentContainer().getComponentInstanceOfType(RepositoryService.class);</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">repository = repositoryService.getDefaultRepository();</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">session = repository.login();</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">rootNode = session.getRootNode();</span><br> <br><b>groovy&gt;</b> <br><b>groovy&gt;</b> println rootNode<br><span style="color: rgb(0, 153, 0);">org.exoplatform.services.jcr.impl.core.NodeImpl@145f173</span><br><b>groovy&gt;</b> <br><b>groovy&gt;</b> rootNode.getNodes().each{println it.name}<br><span style="color: rgb(0, 153, 0);">exo:registry</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">exo:applications</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">exo:services</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Users</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Groups</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Digital Assets</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Documents</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Trash</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Records Space</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">Application Data</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">tags</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">sites content</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">xcmis:system</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">exo:loginHistoryHome</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">exo:groovyConsoleService</span><br><b>groovy&gt;</b>  <br><b>groovy&gt;</b> save session as JcrTest<br><span style="color: rgb(0, 153, 0);">Session was saved successfully to 'JcrTest'</span><br><b>groovy&gt;</b> <br><b>groovy&gt;</b> clear session<br><span style="color: rgb(0, 153, 0);">Session cleared.</span><br><b>groovy&gt;</b> <br><b>groovy&gt;</b> show imports<br><span style="color: rgb(0, 153, 0);">[GroovySession@2011.5.16_7h53m4s]</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 102, 0);"><span style="color: rgb(0, 153, 0);">&lt;empty</span>&gt;</span><br><b>groovy&gt;</b> show variables<br><span style="color: rgb(0, 153, 0);">[GroovySession@2011.5.16_7h53m4s]</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">&lt;empty&gt;</span><br><b>groovy&gt;</b> load session JcrTest<br><span style="color: rgb(0, 153, 0);">Session 'JcrTest' was loaded successfully.</span><br><b>groovy&gt;</b> <br><b>groovy&gt;</b> show imports<br><span style="color: rgb(0, 153, 0);">[GroovySession@2011.5.16_7h53m4s]</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import org.exoplatform.services.jcr.RepositoryService;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Node;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import org.exoplatform.container.ExoContainerContext;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import org.exoplatform.container.StandaloneContainer;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Repository;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Session;</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">import javax.jcr.Property;</span><br> <br><b>groovy&gt;</b> show variables<br><span style="color: rgb(0, 153, 0);">[GroovySession@2011.5.16_7h53m4s]</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">repositoryService = (RepositoryService)ExoContainerContext.getCurrentContainer().getComponentInstanceOfType(RepositoryService.class);</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">repository = repositoryService.getDefaultRepository();</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">session = repository.login();</span><br style="color: rgb(0, 153, 0);"><span style="color: rgb(0, 153, 0);">rootNode = session.getRootNode();</span><br> <br><b>groovy&gt;</b> println rootNode<br><span style="color: rgb(0, 153, 0);">org.exoplatform.services.jcr.impl.core.NodeImpl@1d29612</span><br><b>groovy&gt;</b>  <br> </pre>
<h3 style="color: rgb(255, 212, 0); font-size: 16px;"><span style="color: rgb(255, 204, 0);">
3. Test running function and class definition via copy/paste</span></h3>Copy and paste the following script to the console (use Ctrl-V to paste)  <br>
<pre><span style="color: rgb(0, 0, 102);">class myClass {</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">  String hello() {</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">    return "Hello from class"</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">  }</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">}</span><br style="color: rgb(0, 0, 102);"><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">myFunc()</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">cls = new myClass()</span><br style="color: rgb(0, 0, 102);"><span style="color: rgb(0, 0, 102);">println cls.hello()<br style="color: rgb(0, 0, 102);"></span><b><br></b></pre><small><big><big>The session:</big></big></small><small><small><big><big><br><br></big></big></small></small><span style="font-family: monospace;"><span style="font-weight: bold;">groovy&gt;</span> void myFunc() {</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; println "Hello from function"</span><br style="font-family: monospace;"><span style="font-family: monospace;">}</span><br style="font-family: monospace;"><br style="font-family: monospace;"><span style="font-family: monospace;">class myClass {</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; String hello() {</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; return "Hello from class"</span><br style="font-family: monospace;"><span style="font-family: monospace;">&nbsp; }</span><br style="font-family: monospace;"><span style="font-family: monospace;">}</span><br style="font-family: monospace;"><br style="font-family: monospace;"><span style="font-family: monospace;">myFunc()</span><br style="font-family: monospace;"><span style="font-family: monospace;">cls = new myClass()</span><br style="font-family: monospace;"><span style="font-family: monospace;">println cls.hello()</span><br style="font-family: monospace;"><span style="font-family: monospace; color: rgb(0, 153, 0);">Hello from function</span><br style="font-family: monospace; color: rgb(0, 153, 0);"><span style="font-family: monospace; color: rgb(0, 153, 0);">Hello from class</span><br style="font-family: monospace;"><span style="font-family: monospace; font-weight: bold;">groovy&gt;</span><br style="font-family: monospace;"><br> 
