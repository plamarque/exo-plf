
This How-To describes how to copy a work done on a WCM server, such as creating navigations, nodetypes and templates, to another WCM server.



h2. Step 1 : Copy the site content folder with its versions History

* Go to "Sites Management" drive.
* Open the site's node
* Export the node with its versions history
!how_to_copy_a_site/export_site_nodes2.png!
* Import the exported nodes and versions history
!how_to_copy_a_site/import_site_nodes2.png!
* Wait until the Popup with "Imported successfully" information is displayed !how_to_copy_a_site/import_successfully.png!

h2. Step 2:  How to copy sites navigation nodes

* Add a new Drive in both servers
!how_to_copy_a_site/add_portal_system_drive.png!
* Export navigation nodes
!how_to_copy_a_site/export_site_navigations.png!
* Imports nodes navigation :
!how_to_copy_a_site/import_site_navigations.png!

h2. Step 3: How to copy nodetypes templates
{note}
If you have some specific JCR namespaces and nodetypes, you 'll have to import them in the new Server
{note}
* Add "System" drive in both servers
!how_to_copy_a_site/add_system_drive.png!
* Open "system:/jcr:system/exo:namespaces/\{namespace_name\}", and export it
!how_to_copy_a_site/export_namespace.png!
* Open "system:/jcr:system/exo:namespaces/", and import the exported file
!how_to_copy_a_site/import_namespace.png!
* Open "system:/jcr:system/jcr:nodetypes/\{node_type\}", and export it
!how_to_copy_a_site/export_node_type.png!
* Open "system:/jcr:system/jcr:nodetypes/", and import the exported file
!how_to_copy_a_site/import_nodetype.png!

h2. Step 4: How to copy WCM templates
{note}
If you have some specific WCM (CLV/PCLV) views AND/OR nodetypes templates, you 'll have to import them in the new Server
{note}
* Open "DMS Administration" Drive
* Open "dms-system:/exo:ecm/templates/\{node_type\}", and export it
!how_to_copy_a_site/export_node_type_templates.png!
* Open "dms-system:/exo:ecm/templates/", and import the exported file
!how_to_copy_a_site/import_node_type_templates.png!
&nbsp;
And for the CLV/PCLV templates, you can find all template views defined in this path:
"dms-system:/exo:ecm/views" with:
* userviews: this folder contains the FileExplorer's views, with the set of action ...
* templates: where we could find all gtmpl templates of :
** Category Navigation Portlet templates
** Content List Viewer (CLV) templates and its paginator templates
** content-browser templates (Deprecated Portlet)
** ecm-explorer templates: Those templates are used to define how to display nodes in the right side of the FileExplorer Portlet, such as CoverFlow template, IconView template, ...
** Parameterized Content List Viewer (PCLV) templates and its paginator templates
** WCM Advance Search: for the WCM Search Portlet, with templates to define the form, the layout, the result and the result's paginator.

If you want to reuse one of non predefined templates here, you'll have simply to export it and import it in the new Server at the same place

!how_to_copy_a_site/WCM_templates.png!

h2. Step 5:  How to copy a Taxonomy Tree

By importing the whole site, as described in part 1, you 'll have the Taxonomy tree already imported too, The default location the site's Taxonomy is in a sub-folder named "categories". So, no need to export/import them because this step is automatically done. But the Taxonomy tree definition still isn't fully imported in the new server. And what we have to do now, is simply importing it by:
* Open "DMS Administration" Drive, in the new Server

{warning:title=Original Use Case}
Because of ECMS-1694, we cannot add Symlink by interface, so we 'll have to do it manually
{warning}
* Go to {{dms-system:/exo:ecm/exo:taxonomyTrees/definition/\{taxonomy{{{_}}}name\}}}", and import [this file|How to copy a site^export_taxonomy_definition.xml], but before importing we have to do some modification on it:

{code}
<acme exo:name="acme" exo:uuid="126fd7d8c0a8021d0042e1da8aee2a87" exo:workspace="collaboration"><!--...--></acme>
{code}

The modifications are:
* {{acme}} : Change the element name with the taxonomy Tree name, and do same thing for the property "exo:name".
* {{exo:workspace}} : is the workspace of the original root Taxonomy Tree node
* {{exo:uuid}} : is the jcr:uuid of the original root Taxonomy Tree node. Follow this picture to know how to copy it:

!how_to_copy_a_site/export_acme_taxonomy_definition_jcr_uuid.png!

{note}
In some cases, you have to disconnect/or restart server to see modifications made. (To clean caches)
{note}

h2. Step 6:  How to copy Metadata templates

* Open "DMS Administration" Drive, in the new Server
* Go to "/exo:ecm/metadata/\{meta_data_name\}"
* Export it and re-import it in the same location in the new server&nbsp;


h2. Step 7 :  How to copy Queries

* Open "DMS Administration" Drive, in the new Server
* Go to "/exo:ecm/queries/\{query_name\}"
* Export it and re-import it in the same location in the new server

h2. Step 8 :  How to copy scripts

* Open "DMS Administration" Drive, in the new Server
* Go to "/exo:ecm/scripts/ecm-explorer/"
* You 'll find three folders which refers to the three types of groovy scripts in eXo
** action: Action scripts are launched when an ECM action triggers them (refer to Actions Concept? section for more information).
** interceptor: Interceptor scripts are be triggered before and/or after a JCR node is saved, when a node is created or edited. They are used to either validate the value entered in a form or to manipulate the newly created node. For example to map the new node with a forum thread or any other type of discussion areas.
** widget: Widget scripts are used to fill widgets - such as a select box - in a dynamic way.
** Export your customized script in the same location in the new server

h2. Step 9 :  How to copy drives configurations

* Open "DMS Administration" Drive, in the new Server
* Go to "/exo:ecm/exo:drives/\{query_name\}"
* Export it and re-import it in the same location in the new server

h2. Step 10 :  How to copy Gadgets

* Open the Drive that points into "Portal-System" Workspace
* Go to your gadget "portal-system:/production/app:gadgets/\{gadget_namee\}"
* Export it and re-import it in the same location in the new server

h2. Step 11 :  Restarting Server

* After importing the site navigation nodes, the site will looks like this: !how_to_copy_a_site/acme_site_after_import.png!
* After restarting the server, the Site will looks like this: !how_to_copy_a_site/acme_site_after_import_and_restart.png!